 
(program
  (= GRID_SIZE (list 190 110))
  (= background "white")
  (object ObjType1  (map (--> pos (Cell pos  "darkgray" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType2 (: field1 Int) (map (--> pos (Cell pos  "white" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType3  (map (--> pos (Cell pos  "gold" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType4  (map (--> pos (Cell pos  "red" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType5  (map (--> pos (Cell pos  "pink" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType6  (map (--> pos (Cell pos  "darkblue" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType7 (: field1 Int) (map (--> pos (Cell pos  "lightblue" )) (rect (Position -9 -4) (Position 0 5))))
  
  (: addedObjType1List (List ObjType1))
  (: addedObjType2List (List ObjType2))
  (: addedObjType3List (List ObjType3))
  (: addedObjType4List (List ObjType4))
  (: addedObjType5List (List ObjType5))
  (: obj108 ObjType6)
  
  (: addedObjType6List (List ObjType6))
  (: addedObjType7List (List ObjType7))
  
  (= addedObjType1List (initnext (list (ObjType1  (Position 149 104)) (ObjType1  (Position 19 34)) (ObjType1  (Position 189 14)) (ObjType1  (Position 69 104)) (ObjType1  (Position 79 54)) (ObjType1  (Position 59 104)) (ObjType1  (Position 19 104)) (ObjType1  (Position 79 4)) (ObjType1  (Position 129 74)) (ObjType1  (Position 189 84)) (ObjType1  (Position 9 94)) (ObjType1  (Position 29 104)) (ObjType1  (Position 89 104)) (ObjType1  (Position 39 74)) (ObjType1  (Position 9 24)) (ObjType1  (Position 159 4)) (ObjType1  (Position 9 44)) (ObjType1  (Position 189 24)) (ObjType1  (Position 179 34)) (ObjType1  (Position 159 44)) (ObjType1  (Position 179 54)) (ObjType1  (Position 109 74)) (ObjType1  (Position 129 104)) (ObjType1  (Position 169 34)) (ObjType1  (Position 39 104)) (ObjType1  (Position 49 74)) (ObjType1  (Position 159 104)) (ObjType1  (Position 129 54)) (ObjType1  (Position 99 4)) (ObjType1  (Position 9 74)) (ObjType1  (Position 29 34)) (ObjType1  (Position 69 54)) (ObjType1  (Position 169 4)) (ObjType1  (Position 39 4)) (ObjType1  (Position 189 4)) (ObjType1  (Position 19 74)) (ObjType1  (Position 119 74)) (ObjType1  (Position 49 104)) (ObjType1  (Position 139 34)) (ObjType1  (Position 99 54)) (ObjType1  (Position 129 4)) (ObjType1  (Position 89 4)) (ObjType1  (Position 169 94)) (ObjType1  (Position 29 74)) (ObjType1  (Position 169 104)) (ObjType1  (Position 189 74)) (ObjType1  (Position 189 44)) (ObjType1  (Position 9 34)) (ObjType1  (Position 159 34)) (ObjType1  (Position 89 54)) (ObjType1  (Position 99 104)) (ObjType1  (Position 119 54)) (ObjType1  (Position 189 34)) (ObjType1  (Position 69 4)) (ObjType1  (Position 9 64)) (ObjType1  (Position 9 104)) (ObjType1  (Position 149 34)) (ObjType1  (Position 69 44)) (ObjType1  (Position 189 64)) (ObjType1  (Position 49 34)) (ObjType1  (Position 119 104)) (ObjType1  (Position 79 104)) (ObjType1  (Position 189 94)) (ObjType1  (Position 139 104)) (ObjType1  (Position 109 4)) (ObjType1  (Position 49 84)) (ObjType1  (Position 179 94)) (ObjType1  (Position 9 84)) (ObjType1  (Position 179 104)) (ObjType1  (Position 29 4)) (ObjType1  (Position 9 4)) (ObjType1  (Position 149 4)) (ObjType1  (Position 189 104)) (ObjType1  (Position 189 54)) (ObjType1  (Position 109 54)) (ObjType1  (Position 39 34)) (ObjType1  (Position 179 4)) (ObjType1  (Position 59 4)) (ObjType1  (Position 139 4)) (ObjType1  (Position 119 4)) (ObjType1  (Position 49 4)) (ObjType1  (Position 9 54)) (ObjType1  (Position 19 4)) (ObjType1  (Position 109 104)) (ObjType1  (Position 9 14))) (prev addedObjType1List)))
  (= addedObjType2List (initnext (list (ObjType2 2 (Position 169 44)) (ObjType2 6 (Position 49 54))) (prev addedObjType2List)))
  (= addedObjType3List (initnext (list (ObjType3  (Position 99 94)) (ObjType3  (Position 139 14)) (ObjType3  (Position 119 94)) (ObjType3  (Position 109 94)) (ObjType3  (Position 49 14)) (ObjType3  (Position 179 44)) (ObjType3  (Position 149 14)) (ObjType3  (Position 39 24)) (ObjType3  (Position 39 64)) (ObjType3  (Position 149 24)) (ObjType3  (Position 99 44)) (ObjType3  (Position 19 24)) (ObjType3  (Position 139 24)) (ObjType3  (Position 89 44))) (prev addedObjType3List)))
  (= addedObjType4List (initnext (list (ObjType4  (Position 169 44)) (ObjType4  (Position 39 84)) (ObjType4  (Position 179 14))) (prev addedObjType4List)))
  (= addedObjType5List (initnext (list (ObjType5  (Position 29 54)) (ObjType5  (Position 139 94)) (ObjType5  (Position 179 24))) (prev addedObjType5List)))
  (= obj108 (initnext (ObjType6  (Position 19 14)) (prev obj108)))
  
  (= addedObjType6List (initnext (list) (prev addedObjType6List)))
  (= addedObjType7List (initnext (list) (prev addedObjType7List)))


  (: arrow Position)
  (= arrow (initnext (Position 0 0) (prev arrow)))
  (on true
(= arrow (if left then (Position -10 0) else (if right then (Position 10 0) else (if up then (Position 0 -10) else (if down then (Position 0 10) else (Position 0 0)))))))

  (: time Int)
  (= time (initnext 0 (+ time 1)))

  (on true
(= addedObjType7List (updateObj addedObjType7List (--> obj (uniformChoice (list  (moveNoCollisionColor (prev obj) 0 -10 "darkgray") (moveNoCollisionColor (prev obj) 0 10 "darkgray") (moveNoCollisionColor (prev obj) 10 0 "darkgray") (moveNoCollisionColor (prev obj) -10 0 "darkgray"))))) (--> obj (& true (== (.. obj field1) 1)))))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (moveNoCollisionColor (prev obj) (closestRandom (prev obj) (list ObjType6) 5) "darkgray")) (--> obj (& true (== (.. obj field1) 1))))))
  (on true
(= addedObjType3List (removeObj addedObjType3List (--> obj (moveIntersects arrow (prev obj108) (list (prev obj)))))))
  (on (!= arrow (Position 0 0))
(= obj108 (moveNoCollisionColor (prev obj108) (.. arrow x) (.. arrow y) "darkgray")))
  (on (adj (prev obj108) (filter (--> obj2 (== (.. obj2 field1) 1)) (prev addedObjType2List)) 10)
(= obj108 (removeObj (prev obj108))))
  (on true
(= addedObjType7List (updateObj addedObjType7List (--> obj (updateObj obj "field1" 3)) (--> obj (& true (intersects (list 4) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType7List (updateObj addedObjType7List (--> obj (updateObj obj "field1" 2)) (--> obj (& true (intersects (list 3) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType7List (updateObj addedObjType7List (--> obj (updateObj obj "field1" 1)) (--> obj (& true (intersects (list 2) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType7List (updateObj addedObjType7List (--> obj (updateObj obj "field1" 3)) (--> obj (& true (intersects (list 1) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (updateObj obj "field1" 6)) (--> obj (& true (intersects (list 7) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (updateObj obj "field1" 5)) (--> obj (& true (intersects (list 6) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (updateObj obj "field1" 4)) (--> obj (& true (intersects (list 5) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (updateObj obj "field1" 3)) (--> obj (& true (intersects (list 4) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (updateObj obj "field1" 2)) (--> obj (& true (intersects (list 3) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (updateObj obj "field1" 1)) (--> obj (& true (intersects (list 2) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType2List (updateObj addedObjType2List (--> obj (updateObj obj "field1" 6)) (--> obj (& true (intersects (list 1) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on (& (& (!= (filter (--> obj (<= (distance (prev obj) (prev addedObjType7List)) 20)) (prev addedObjType2List)) (list)) (== (uniformChoice (list 1 2 3 4 5 6 7 8 9 10)) 1)) (!= (filter (--> obj (<= (distance (prev obj) (prev addedObjType7List)) 20)) (prev addedObjType2List)) (list)))
(let ((= addedObjType3List (addObj addedObjType3List (ObjType3  (move (firstWithDefault (map (--> obj (.. obj origin)) (filter (--> obj (<= (distance (prev obj) (prev addedObjType5List)) 20)) (prev addedObjType7List)))) (uniformChoice (list (Position 0 (uniformChoice (list 10))) (Position 0 (uniformChoice (list -10))) (Position (uniformChoice (list 10)) 0) (Position (uniformChoice (list -10)) 0))))))) (= addedObjType2List (removeObj addedObjType2List (--> obj (== (.. obj id) x))))	(= addedObjType7List (removeObj addedObjType7List (--> obj (== (.. obj id) x)))))))
  (on (== (uniformChoice (list 1 2 3 4 5 6 7 8 9 10)) 1)
(= addedObjType7List (addObj addedObjType7List (ObjType7 4  (.. (uniformChoice (vcat (prev addedObjType5List) (prev addedObjType5List) (prev addedObjType5List) (prev addedObjType5List) (prev addedObjType5List) (prev addedObjType5List))) origin)))))
  (on (== (uniformChoice (list 1 2 3 4 5 6 7 8 9 10)) 1)
(= addedObjType2List (addObj addedObjType2List (ObjType2 7  (.. (uniformChoice (vcat (prev addedObjType4List) (prev addedObjType4List) (prev addedObjType4List) (prev addedObjType4List) (prev addedObjType4List) (prev addedObjType4List))) origin))))))
