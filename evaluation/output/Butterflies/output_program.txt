 
(program
  (= GRID_SIZE (list 280 110))
  (= background "white")
  (object ObjType1  (map (--> pos (Cell pos  "darkgray" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType2  (map (--> pos (Cell pos  "green" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType3  (map (--> pos (Cell pos  "pink" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType4  (map (--> pos (Cell pos  "darkblue" )) (rect (Position -9 -4) (Position 0 5))))
  
  (: addedObjType1List (List ObjType1))
  (: addedObjType2List (List ObjType2))
  (: addedObjType3List (List ObjType3))
  (: obj136 ObjType4)
  
  (: addedObjType4List (List ObjType4))
  
  (= addedObjType1List (initnext (list (ObjType1  (Position 119 104)) (ObjType1  (Position 9 54)) (ObjType1  (Position 109 4)) (ObjType1  (Position 9 84)) (ObjType1  (Position 239 4)) (ObjType1  (Position 149 4)) (ObjType1  (Position 119 74)) (ObjType1  (Position 179 4)) (ObjType1  (Position 179 104)) (ObjType1  (Position 69 44)) (ObjType1  (Position 119 44)) (ObjType1  (Position 259 104)) (ObjType1  (Position 189 4)) (ObjType1  (Position 139 74)) (ObjType1  (Position 129 104)) (ObjType1  (Position 59 104)) (ObjType1  (Position 29 104)) (ObjType1  (Position 29 44)) (ObjType1  (Position 159 4)) (ObjType1  (Position 99 4)) (ObjType1  (Position 49 4)) (ObjType1  (Position 219 4)) (ObjType1  (Position 229 104)) (ObjType1  (Position 129 14)) (ObjType1  (Position 219 104)) (ObjType1  (Position 49 44)) (ObjType1  (Position 9 104)) (ObjType1  (Position 269 104)) (ObjType1  (Position 279 104)) (ObjType1  (Position 279 64)) (ObjType1  (Position 39 44)) (ObjType1  (Position 19 84)) (ObjType1  (Position 279 34)) (ObjType1  (Position 249 4)) (ObjType1  (Position 219 94)) (ObjType1  (Position 69 104)) (ObjType1  (Position 59 4)) (ObjType1  (Position 199 4)) (ObjType1  (Position 169 4)) (ObjType1  (Position 79 4)) (ObjType1  (Position 9 94)) (ObjType1  (Position 9 44)) (ObjType1  (Position 59 44)) (ObjType1  (Position 9 74)) (ObjType1  (Position 279 4)) (ObjType1  (Position 279 24)) (ObjType1  (Position 139 104)) (ObjType1  (Position 19 4)) (ObjType1  (Position 279 94)) (ObjType1  (Position 209 54)) (ObjType1  (Position 39 104)) (ObjType1  (Position 279 44)) (ObjType1  (Position 159 104)) (ObjType1  (Position 19 44)) (ObjType1  (Position 29 84)) (ObjType1  (Position 79 44)) (ObjType1  (Position 279 14)) (ObjType1  (Position 149 104)) (ObjType1  (Position 199 104)) (ObjType1  (Position 229 4)) (ObjType1  (Position 169 104)) (ObjType1  (Position 129 4)) (ObjType1  (Position 89 104)) (ObjType1  (Position 149 74)) (ObjType1  (Position 209 4)) (ObjType1  (Position 19 104)) (ObjType1  (Position 49 104)) (ObjType1  (Position 9 64)) (ObjType1  (Position 9 14)) (ObjType1  (Position 139 4)) (ObjType1  (Position 269 4)) (ObjType1  (Position 119 4)) (ObjType1  (Position 279 54)) (ObjType1  (Position 129 74)) (ObjType1  (Position 279 74)) (ObjType1  (Position 279 84)) (ObjType1  (Position 79 104)) (ObjType1  (Position 109 44)) (ObjType1  (Position 269 54)) (ObjType1  (Position 89 44)) (ObjType1  (Position 39 84)) (ObjType1  (Position 209 104)) (ObjType1  (Position 189 104)) (ObjType1  (Position 99 44)) (ObjType1  (Position 39 4)) (ObjType1  (Position 49 84)) (ObjType1  (Position 239 34)) (ObjType1  (Position 9 34)) (ObjType1  (Position 249 104)) (ObjType1  (Position 239 104)) (ObjType1  (Position 109 104)) (ObjType1  (Position 259 4)) (ObjType1  (Position 69 4)) (ObjType1  (Position 239 24)) (ObjType1  (Position 29 4)) (ObjType1  (Position 239 14)) (ObjType1  (Position 9 4)) (ObjType1  (Position 9 24)) (ObjType1  (Position 219 84)) (ObjType1  (Position 99 104)) (ObjType1  (Position 159 74)) (ObjType1  (Position 89 4))) (prev addedObjType1List)))
  (= addedObjType2List (initnext (list (ObjType2  (Position 269 44)) (ObjType2  (Position 119 94)) (ObjType2  (Position 259 14)) (ObjType2  (Position 189 14)) (ObjType2  (Position 269 14)) (ObjType2  (Position 19 54)) (ObjType2  (Position 249 14)) (ObjType2  (Position 159 94)) (ObjType2  (Position 269 74)) (ObjType2  (Position 139 94)) (ObjType2  (Position 259 24)) (ObjType2  (Position 89 34)) (ObjType2  (Position 19 74)) (ObjType2  (Position 269 94)) (ObjType2  (Position 99 94)) (ObjType2  (Position 269 24)) (ObjType2  (Position 249 24)) (ObjType2  (Position 19 64)) (ObjType2  (Position 259 34)) (ObjType2  (Position 179 94)) (ObjType2  (Position 169 14)) (ObjType2  (Position 249 34)) (ObjType2  (Position 259 44)) (ObjType2  (Position 229 14)) (ObjType2  (Position 229 94)) (ObjType2  (Position 209 14)) (ObjType2  (Position 269 34))) (prev addedObjType2List)))
  (= addedObjType3List (initnext (list (ObjType3  (Position 209 74)) (ObjType3  (Position 39 14)) (ObjType3  (Position 29 24)) (ObjType3  (Position 89 64)) (ObjType3  (Position 49 34)) (ObjType3  (Position 99 14))) (prev addedObjType3List)))
  (= obj136 (initnext (ObjType4  (Position 149 34)) (prev obj136)))
  
  (= addedObjType4List (initnext (list) (prev addedObjType4List)))


  (: arrow Position)
  (= arrow (initnext (Position 0 0) (prev arrow)))
  (on true
(= arrow (if left then (Position -10 0) else (if right then (Position 10 0) else (if up then (Position 0 -10) else (if down then (Position 0 10) else (Position 0 0)))))))

  (: time Int)
  (= time (initnext 0 (+ time 1)))

  (on (!= arrow (Position 0 0))
(= obj136 (moveNoCollisionColor (prev obj136) (.. arrow x) (.. arrow y) "darkgray")))
  (on true
(= addedObjType3List (updateObj addedObjType3List (--> obj (uniformChoice (list  (moveNoCollisionColor (prev obj) 0 -6 "darkgray")  (moveNoCollisionColor (prev obj) 0 6 "darkgray")  (prev obj)  (moveNoCollisionColor (prev obj) 0 10 "darkgray")  (moveNoCollisionColor (prev obj) 0 12 "darkgray")  (moveNoCollisionColor (prev obj) 0 14 "darkgray")  (moveNoCollisionColor (prev obj) 0 2 "darkgray")  (moveNoCollisionColor (prev obj) 0 4 "darkgray")  (moveNoCollisionColor (prev obj) 0 8 "darkgray")  (moveNoCollisionColor (prev obj) 6 0 "darkgray")  (moveNoCollisionColor (prev obj) -6 0 "darkgray")  (moveNoCollisionColor (prev obj) -14 -10 "darkgray")  (moveNoCollisionColor (prev obj) 0 -10 "darkgray")  (moveNoCollisionColor (prev obj) 0 -12 "darkgray")  (moveNoCollisionColor (prev obj) 0 -14 "darkgray")  (moveNoCollisionColor (prev obj) 0 -8 "darkgray")  (moveNoCollisionColor (prev obj) -8 -4 "darkgray")  (moveNoCollisionColor (prev obj) 2 10 "darkgray")  (moveNoCollisionColor (prev obj) -10 0 "darkgray")  (moveNoCollisionColor (prev obj) -12 0 "darkgray")  (moveNoCollisionColor (prev obj) -14 0 "darkgray")  (moveNoCollisionColor (prev obj) -8 0 "darkgray")  (moveNoCollisionColor (prev obj) -4 0 "darkgray")  (moveNoCollisionColor (prev obj) -2 2 "darkgray")  (moveNoCollisionColor (prev obj) 0 -4 "darkgray")  (moveNoCollisionColor (prev obj) 2 4 "darkgray")   (moveNoCollisionColor (prev obj) -2 0 "darkgray")  (moveNoCollisionColor (prev obj) 4 -10 "darkgray")  (moveNoCollisionColor (prev obj) 10 0 "darkgray")  (moveNoCollisionColor (prev obj) 12 0 "darkgray")  (moveNoCollisionColor (prev obj) 14 0 "darkgray")  (moveNoCollisionColor (prev obj) 2 0 "darkgray")  (moveNoCollisionColor (prev obj) 4 0 "darkgray")  (moveNoCollisionColor (prev obj) 8 0 "darkgray")  (moveNoCollisionColor (prev obj) 6 -6 "darkgray")  (moveNoCollisionColor (prev obj) 0 -2 "darkgray")  (moveNoCollisionColor (prev obj) 4 2 "darkgray")  (moveNoCollisionColor (prev obj) 2 -2 "darkgray"))))) (--> obj true)))
  (on (& (& (!= (filter (--> obj (<= (distance (prev obj) (prev addedObjType3List)) 20)) (prev addedObjType2List)) (list)) (== (uniformChoice (list 1 2 3 4 5 6 7 8 9 10)) 1)) (!= (filter (--> obj (<= (distance (prev obj) (prev addedObjType3List)) 20)) (prev addedObjType2List)) (list)))
(let ((= addedObjType3List (addObj addedObjType3List (ObjType3  (move (firstWithDefault (map (--> obj (.. obj origin)) (filter (--> obj (<= (distance (prev obj) (prev addedObjType2List)) 20)) (prev addedObjType3List)))) (uniformChoice (list (Position 0 (uniformChoice (list 2 4 6 8 10 12 14))) (Position 0 (uniformChoice (list -2 -4 -6 -8 -10 -12 -14))) (Position (uniformChoice (list 2 4 6 8 10 12 14)) 0) (Position (uniformChoice (list -2 -4 -6 -8 -10 -12 -14)) 0))))))) (= addedObjType2List (removeObj addedObjType2List (--> obj (== (.. obj id) x))))))))
