 
(program
  (= GRID_SIZE (list 210 110))
  (= background "white")
  (object ObjType1  (map (--> pos (Cell pos  "darkgray" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType2  (map (--> pos (Cell pos  "green" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType3  (map (--> pos (Cell pos  "purple" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType4  (map (--> pos (Cell pos  "lightblue" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType5 (: field1 Int) (map (--> pos (Cell pos  "red" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType6  (map (--> pos (Cell pos  "darkblue" )) (rect (Position -9 -4) (Position 0 5))))
  (object ObjType7 (: field1 Int) (map (--> pos (Cell pos  "brown" )) (rect (Position -9 -4) (Position 0 5))))
  
  (: addedObjType1List (List ObjType1))
  (: obj122 ObjType2)
  (: obj123 ObjType3)
  (: addedObjType4List (List ObjType4))
  (: addedObjType5List (List ObjType5))
  (: obj134 ObjType6)
  
  (: addedObjType2List (List ObjType2))
  (: addedObjType3List (List ObjType3))
  (: addedObjType6List (List ObjType6))
  (: addedObjType7List (List ObjType7))
  
  (= addedObjType1List (initnext (list (ObjType1  (Position 29 104)) (ObjType1  (Position 69 4)) (ObjType1  (Position 79 24)) (ObjType1  (Position 139 44)) (ObjType1  (Position 159 44)) (ObjType1  (Position 69 104)) (ObjType1  (Position 9 4)) (ObjType1  (Position 79 4)) (ObjType1  (Position 89 104)) (ObjType1  (Position 209 104)) (ObjType1  (Position 129 14)) (ObjType1  (Position 169 104)) (ObjType1  (Position 159 64)) (ObjType1  (Position 29 4)) (ObjType1  (Position 59 104)) (ObjType1  (Position 209 44)) (ObjType1  (Position 209 64)) (ObjType1  (Position 79 14)) (ObjType1  (Position 129 54)) (ObjType1  (Position 149 14)) (ObjType1  (Position 99 34)) (ObjType1  (Position 119 54)) (ObjType1  (Position 159 14)) (ObjType1  (Position 159 54)) (ObjType1  (Position 179 4)) (ObjType1  (Position 19 104)) (ObjType1  (Position 89 64)) (ObjType1  (Position 139 64)) (ObjType1  (Position 39 64)) (ObjType1  (Position 139 14)) (ObjType1  (Position 39 4)) (ObjType1  (Position 129 84)) (ObjType1  (Position 109 64)) (ObjType1  (Position 99 104)) (ObjType1  (Position 39 84)) (ObjType1  (Position 149 4)) (ObjType1  (Position 109 14)) (ObjType1  (Position 189 4)) (ObjType1  (Position 109 74)) (ObjType1  (Position 119 44)) (ObjType1  (Position 139 104)) (ObjType1  (Position 79 84)) (ObjType1  (Position 89 4)) (ObjType1  (Position 89 54)) (ObjType1  (Position 159 104)) (ObjType1  (Position 19 4)) (ObjType1  (Position 129 4)) (ObjType1  (Position 9 24)) (ObjType1  (Position 209 54)) (ObjType1  (Position 169 24)) (ObjType1  (Position 9 14)) (ObjType1  (Position 79 74)) (ObjType1  (Position 209 34)) (ObjType1  (Position 9 104)) (ObjType1  (Position 39 104)) (ObjType1  (Position 69 14)) (ObjType1  (Position 109 44)) (ObjType1  (Position 149 34)) (ObjType1  (Position 99 4)) (ObjType1  (Position 9 94)) (ObjType1  (Position 209 14)) (ObjType1  (Position 159 84)) (ObjType1  (Position 209 84)) (ObjType1  (Position 139 74)) (ObjType1  (Position 9 54)) (ObjType1  (Position 59 44)) (ObjType1  (Position 119 4)) (ObjType1  (Position 159 4)) (ObjType1  (Position 199 4)) (ObjType1  (Position 119 14)) (ObjType1  (Position 9 34)) (ObjType1  (Position 49 64)) (ObjType1  (Position 129 64)) (ObjType1  (Position 139 34)) (ObjType1  (Position 189 34)) (ObjType1  (Position 99 54)) (ObjType1  (Position 129 34)) (ObjType1  (Position 99 64)) (ObjType1  (Position 139 84)) (ObjType1  (Position 149 74)) (ObjType1  (Position 209 4)) (ObjType1  (Position 209 74)) (ObjType1  (Position 79 104)) (ObjType1  (Position 179 104)) (ObjType1  (Position 49 4)) (ObjType1  (Position 169 4)) (ObjType1  (Position 119 104)) (ObjType1  (Position 189 104)) (ObjType1  (Position 199 104)) (ObjType1  (Position 149 84)) (ObjType1  (Position 149 104)) (ObjType1  (Position 99 44)) (ObjType1  (Position 159 24)) (ObjType1  (Position 9 44)) (ObjType1  (Position 49 104)) (ObjType1  (Position 179 34)) (ObjType1  (Position 59 4)) (ObjType1  (Position 209 24)) (ObjType1  (Position 69 34)) (ObjType1  (Position 109 54)) (ObjType1  (Position 149 64)) (ObjType1  (Position 109 34)) (ObjType1  (Position 119 34)) (ObjType1  (Position 119 64)) (ObjType1  (Position 9 74)) (ObjType1  (Position 69 44)) (ObjType1  (Position 149 54)) (ObjType1  (Position 39 44)) (ObjType1  (Position 39 54)) (ObjType1  (Position 9 84)) (ObjType1  (Position 129 104)) (ObjType1  (Position 49 54)) (ObjType1  (Position 89 44)) (ObjType1  (Position 109 104)) (ObjType1  (Position 79 64)) (ObjType1  (Position 139 4)) (ObjType1  (Position 129 44)) (ObjType1  (Position 209 94)) (ObjType1  (Position 69 24)) (ObjType1  (Position 9 64)) (ObjType1  (Position 109 4))) (prev addedObjType1List)))
  (= obj122 (initnext (ObjType2  (Position 39 34)) (prev obj122)))
  (= obj123 (initnext (ObjType3  (Position 179 94)) (prev obj123)))
  (= addedObjType4List (initnext (list (ObjType4  (Position 149 24)) (ObjType4  (Position 119 24)) (ObjType4  (Position 69 84)) (ObjType4  (Position 139 54)) (ObjType4  (Position 69 64)) (ObjType4  (Position 99 24)) (ObjType4  (Position 69 74)) (ObjType4  (Position 49 44)) (ObjType4  (Position 109 24))) (prev addedObjType4List)))
  (= addedObjType5List (initnext (list (ObjType5 2 (Position 179 94))) (prev addedObjType5List)))
  (= obj134 (initnext (ObjType6  (Position 39 94)) (prev obj134)))
  
  (= addedObjType2List (initnext (list) (prev addedObjType2List)))
  (= addedObjType3List (initnext (list) (prev addedObjType3List)))
  (= addedObjType6List (initnext (list) (prev addedObjType6List)))
  (= addedObjType7List (initnext (list) (prev addedObjType7List)))

	 (: globalVar1 Int)
	 (= globalVar1 (initnext 3 (prev globalVar1)))

  (: arrow Position)
  (= arrow (initnext (Position 0 0) (prev arrow)))
  (on true
(= arrow (if left then (Position -10 0) else (if right then (Position 10 0) else (if up then (Position 0 -10) else (if down then (Position 0 10) else (Position 0 0)))))))

  (: time Int)
  (= time (initnext 0 (+ time 1)))

  (on true
(= addedObjType7List (removeObj addedObjType7List (--> obj (& true (== (.. obj field1) 1))))))
  (on true
(= addedObjType5List (updateObj addedObjType5List (--> obj (moveNoCollisionColor (prev obj) (closestRandom (prev obj) (list ObjType2) 10) "darkgray")) (--> obj (& (== (% (prev time) 5) 0) (== (.. obj field1) 1))))))
  (on true
(= addedObjType5List (removeObj addedObjType5List (--> obj (& (adj (prev obj122) (list (prev obj)) 10) (== (% (prev time) 5) 0))))))
  (on (!= arrow (Position 0 0))
(= obj134 (moveNoCollisionColor (prev obj134) (.. arrow x) (.. arrow y) "darkgray")))
  (on true
(= addedObjType1List (removeObj addedObjType1List (--> obj (intersects (list (prev obj)) (prev addedObjType7List))))))
  (on up
(= globalVar1 2))
  (on right
(= globalVar1 3))
  (on down
(= globalVar1 4))
  (on left
(= globalVar1 1))
  (on true
(= addedObjType5List (updateObj addedObjType5List (--> obj (updateObj obj "field1" 1)) (--> obj true) )))
  (on true
(= addedObjType7List (updateObj addedObjType7List (--> obj (updateObj obj "field1" 2)) (--> obj (& true (intersects (list 3) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on true
(= addedObjType7List (updateObj addedObjType7List (--> obj (updateObj obj "field1" 1)) (--> obj (& true (intersects (list 2) (map (--> obj (.. obj field1)) (list (prev obj)))))) )))
  (on (& (== (prev globalVar1) 3) clicked)
(= addedObjType7List (addObj addedObjType7List (ObjType7 3  (move (.. (prev obj134) origin) (Position 10 0))))))
  (on (& (== (prev globalVar1) 2) clicked)
(= addedObjType7List (addObj addedObjType7List (ObjType7 3  (move (.. (prev obj134) origin) (Position 0 -10))))))
  (on (& (== (prev globalVar1) 4) clicked)
(= addedObjType7List (addObj addedObjType7List (ObjType7 3  (move (.. (prev obj134) origin) (Position 0 10))))))
  (on (& (== (prev globalVar1) 1) clicked)
(= addedObjType7List (addObj addedObjType7List (ObjType7 3  (move (.. (prev obj134) origin) (Position -10 0))))))
  (on (== (% (prev time) 50) 49)
(let ((= addedObjType5List (addObj addedObjType5List (ObjType5 2  (Position 179 94))))))))
